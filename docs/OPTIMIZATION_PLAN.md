# Gridix å…¨é¢ä¼˜åŒ–è®¡åˆ’

## ç›®æ ‡

å°† Gridix æ‰“é€ æˆ**çº¯é”®ç›˜é©±åŠ¨çš„ TUI çº§åˆ«æ“ä½œä½“éªŒ**ï¼ŒåŒæ—¶æ•´åˆå¸‚é¢ä¸Šä¸»æµæ•°æ®åº“å·¥å…·ï¼ˆDataGripã€DBeaverã€TablePlusã€Beekeeper Studioã€LazySQLï¼‰çš„æœ€ä½³åŠŸèƒ½ã€‚

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šé”®ç›˜æ“ä½œä½“éªŒä¼˜åŒ–ï¼ˆTUI çº§åˆ«ï¼‰

### 1.1 å½“å‰é—®é¢˜åˆ†æ

| ç»„ä»¶ | å½“å‰çŠ¶æ€ | é—®é¢˜ |
|------|---------|------|
| **DataGrid** | âœ… ä¼˜ç§€ | å®Œæ•´çš„ Helix é£æ ¼é”®ä½ |
| **Sidebar** | âœ… è‰¯å¥½ | æ”¯æŒ hjkl å’Œå±‚çº§å¯¼èˆª |
| **SQL Editor** | âš ï¸ ä¸€èˆ¬ | ç¼ºå°‘æŸ¥æ‰¾æ›¿æ¢å¿«æ·é”® |
| **Toolbar** | âŒ å·® | ä¸»é¢˜é€‰æ‹©å™¨/ä¸‹æ‹‰èœå•ç¼ºå°‘é”®ç›˜å¯¼èˆª |
| **Dialogs** | âŒ å·® | DDL/åˆ›å»ºæ•°æ®åº“/åˆ›å»ºç”¨æˆ·å¯¹è¯æ¡†ç¼ºå°‘é”®ç›˜å¯¼èˆª |
| **ER Diagram** | âŒ å·® | å®Œå…¨ä¾èµ–é¼ æ ‡ |
| **ComboBox/Dropdown** | âŒ å·® | æ— ç»Ÿä¸€é”®ç›˜æ”¯æŒ |

### 1.2 ä¼˜åŒ–æ–¹æ¡ˆ

#### 1.2.1 ç»Ÿä¸€å‘½ä»¤é¢æ¿ (Command Palette) - é«˜ä¼˜å…ˆçº§

**å‚è€ƒ**: DataGrip çš„ Find Action (Ctrl+Shift+A), VSCode çš„ Command Palette

```
å¿«æ·é”®: Ctrl+P æˆ– Ctrl+Shift+P

åŠŸèƒ½:
- æ¨¡ç³Šæœç´¢æ‰€æœ‰å¯ç”¨å‘½ä»¤
- æ˜¾ç¤ºå‘½ä»¤å¯¹åº”çš„å¿«æ·é”®
- æ”¯æŒæœ€è¿‘ä½¿ç”¨å‘½ä»¤
- åˆ†ç±»è¿‡æ»¤ (è¿æ¥ã€æŸ¥è¯¢ã€è¡¨ã€å¯¼å‡ºç­‰)

ç•Œé¢:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ > è¾“å…¥å‘½ä»¤...                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”— æ–°å»ºè¿æ¥                        Ctrl+N   â”‚
â”‚ ğŸ“Š å¯¼å‡ºç»“æœ                        Ctrl+E   â”‚
â”‚ ğŸ” æ·»åŠ ç­›é€‰                        Ctrl+F   â”‚
â”‚ ğŸ“ æ ¼å¼åŒ– SQL                      Ctrl+;   â”‚
â”‚ ğŸ¨ åˆ‡æ¢ä¸»é¢˜...                     Ctrl+T   â”‚
â”‚ ...                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°è¦ç‚¹**:
- æ–°å»º `src/ui/components/command_palette.rs`
- æ³¨å†Œæ‰€æœ‰å‘½ä»¤åˆ°ç»Ÿä¸€çš„å‘½ä»¤æ³¨å†Œä¸­å¿ƒ
- æ”¯æŒ j/k å¯¼èˆªï¼ŒEnter æ‰§è¡Œï¼ŒEsc å…³é—­
- æ¨¡ç³ŠåŒ¹é…ç®—æ³•ï¼ˆæ‹¼éŸ³é¦–å­—æ¯æ”¯æŒï¼‰

#### 1.2.2 ç»Ÿä¸€ä¸‹æ‹‰é€‰æ‹©å™¨ (Helix Picker) - é«˜ä¼˜å…ˆçº§

**å‚è€ƒ**: Helix çš„ file picker, LazySQL çš„é€‰æ‹©å™¨

ä¸ºæ‰€æœ‰ä¸‹æ‹‰èœå•æä¾›ç»Ÿä¸€çš„é”®ç›˜äº¤äº’:

```rust
// src/ui/components/helix_picker.rs

pub struct HelixPicker<T> {
    items: Vec<T>,
    selected: usize,
    filter: String,
    is_open: bool,
}

impl<T> HelixPicker<T> {
    // é”®ç›˜å¤„ç†:
    // - j/k æˆ– Ctrl+n/p: ä¸Šä¸‹é€‰æ‹©
    // - Enter: ç¡®è®¤é€‰æ‹©
    // - Esc: å–æ¶ˆ
    // - /: å¼€å§‹è¿‡æ»¤
    // - å­—æ¯: å¢é‡æœç´¢
}
```

**åº”ç”¨åœºæ™¯**:
- ä¸»é¢˜é€‰æ‹©å™¨
- æ•°æ®åº“ç±»å‹é€‰æ‹©
- SSL æ¨¡å¼é€‰æ‹©
- åˆ—ç±»å‹é€‰æ‹©ï¼ˆDDL å¯¹è¯æ¡†ï¼‰
- ç­›é€‰æ“ä½œç¬¦é€‰æ‹©

#### 1.2.3 å¯¹è¯æ¡†é”®ç›˜å¯¼èˆªç³»ç»Ÿ - é«˜ä¼˜å…ˆçº§

**é—®é¢˜**: å½“å‰å¤§å¤šæ•°å¯¹è¯æ¡†åªæ”¯æŒ Enter/Escï¼Œç¼ºå°‘å­—æ®µé—´å¯¼èˆªã€‚

**æ–¹æ¡ˆ**: å¼•å…¥ Tab ç»„å¯¼èˆª + å¿«æ·é”®

```
å¯¹è¯æ¡†å¯¼èˆªè§„åˆ™:
- Tab/Shift+Tab: å­—æ®µé—´å¾ªç¯
- j/k (åœ¨é€‰æ‹©å™¨å†…): ä¸Šä¸‹é€‰æ‹©
- Enter: ç¡®è®¤å½“å‰é€‰æ‹©æˆ–æäº¤
- Esc: å…³é—­å¯¹è¯æ¡†
- Ctrl+1/2/3...: å¿«é€Ÿè·³è½¬åˆ°ç¬¬ N ä¸ªå­—æ®µç»„

è¿æ¥å¯¹è¯æ¡†ç¤ºä¾‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”— æ–°å»ºæ•°æ®åº“è¿æ¥                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [1] SQLite  [2] PostgreSQL  [3] MySQL       â”‚ â† h/l åˆ‡æ¢
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¿æ¥åç§°: [________________]                â”‚ â† Tab å¯¼èˆª
â”‚ ä¸»æœºåœ°å€: [________________]                â”‚
â”‚ ç«¯å£:     [____]                            â”‚
â”‚ ç”¨æˆ·å:   [________________]                â”‚
â”‚ å¯†ç :     [________________]                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         [å–æ¶ˆ Esc]    [ä¿å­˜ Enter]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éœ€è¦æ›´æ–°çš„å¯¹è¯æ¡†**:
- `connection_dialog.rs` - âœ… å·²æœ‰åŸºç¡€ï¼Œéœ€å¢å¼º
- `ddl_dialog.rs` - éœ€è¦å®Œå–„å­—æ®µå¯¼èˆª
- `create_db_dialog.rs` - éœ€è¦æ·»åŠ é”®ç›˜æ”¯æŒ
- `create_user_dialog.rs` - éœ€è¦æ·»åŠ é”®ç›˜æ”¯æŒ
- `export_dialog.rs` - éœ€è¦æ·»åŠ é”®ç›˜æ”¯æŒ
- `import_dialog/mod.rs` - éœ€è¦æ·»åŠ é”®ç›˜æ”¯æŒ
- `keybindings_dialog.rs` - éœ€è¦æ·»åŠ é”®ç›˜æ”¯æŒ

#### 1.2.4 ER å›¾é”®ç›˜å¯¼èˆª - ä¸­ä¼˜å…ˆçº§

**å½“å‰é—®é¢˜**: å®Œå…¨ä¾èµ–é¼ æ ‡æ‹–åŠ¨

**æ–¹æ¡ˆ**:
```
ER å›¾é”®ç›˜æ“ä½œ:
- hjkl: ç§»åŠ¨é€‰ä¸­çš„è¡¨
- Tab/Shift+Tab: åœ¨è¡¨ä¹‹é—´å¾ªç¯
- Enter: å±•å¼€/æŠ˜å è¡¨è¯¦æƒ…
- f: èšç„¦åˆ°æœç´¢æ¡†ï¼Œè¿‡æ»¤è¡¨
- z: ç¼©æ”¾æ§åˆ¶ (zi æ”¾å¤§, zo ç¼©å°, z0 é‡ç½®)
- c: å±…ä¸­è§†å›¾
- r: é‡æ–°å¸ƒå±€
- /: æœç´¢è¡¨å
```

**å®ç°**:
```rust
// src/ui/components/er_diagram/keyboard.rs

pub struct ERDiagramKeyboard;

impl ERDiagramKeyboard {
    pub fn handle(
        state: &mut ERDiagramState,
        ctx: &egui::Context,
    ) -> ERDiagramActions {
        // å®ç°é”®ç›˜å¤„ç†é€»è¾‘
    }
}
```

#### 1.2.5 å·¥å…·æ é”®ç›˜å¢å¼º - ä¸­ä¼˜å…ˆçº§

**å½“å‰çŠ¶æ€**: æœ‰åŸºç¡€çš„ç„¦ç‚¹å¯¼èˆªï¼Œä½†ä¸‹æ‹‰èœå•ä¸æ”¯æŒé”®ç›˜

**æ–¹æ¡ˆ**:
```
å·¥å…·æ é”®ç›˜æ“ä½œ:
- h/l: åœ¨å·¥å…·æ é¡¹ç›®é—´ç§»åŠ¨
- j: æ‰“å¼€å½“å‰é¡¹çš„ä¸‹æ‹‰èœå• / å‘ä¸‹è¿›å…¥ä¸»åŒºåŸŸ
- k: å‘ä¸Šï¼ˆå¦‚æœæœ‰ä¸Šå±‚åŒºåŸŸï¼‰
- Enter/Space: æ¿€æ´»å½“å‰é¡¹
- æ•°å­—é”®: å¿«é€Ÿè®¿é—® (1=ä¾§è¾¹æ , 2=ç¼–è¾‘å™¨, 3=åˆ·æ–°...)

ä¸‹æ‹‰èœå•å†…:
- j/k: ä¸Šä¸‹é€‰æ‹©
- Enter: æ‰§è¡Œé€‰ä¸­é¡¹
- Esc/h: å…³é—­èœå•
- l: è¿›å…¥å­èœå•ï¼ˆå¦‚æœ‰ï¼‰
```

#### 1.2.6 SQL ç¼–è¾‘å™¨å¢å¼º - ä¸­ä¼˜å…ˆçº§

**ç¼ºå¤±åŠŸèƒ½**:
- æŸ¥æ‰¾æ›¿æ¢ (Ctrl+F / Ctrl+H)
- è·³è½¬åˆ°è¡Œ (Ctrl+G)
- å¤šå…‰æ ‡ç¼–è¾‘
- ä»£ç æŠ˜å 

**æ–¹æ¡ˆ**:
```rust
// æ–°å¢åŠŸèƒ½
SQL ç¼–è¾‘å™¨å¿«æ·é”®:
- Ctrl+F: æŸ¥æ‰¾ï¼ˆå¼¹å‡ºæŸ¥æ‰¾æ ï¼‰
- Ctrl+H: æŸ¥æ‰¾æ›¿æ¢
- Ctrl+G: è·³è½¬åˆ°è¡Œ
- Ctrl+D: é€‰æ‹©ä¸‹ä¸€ä¸ªç›¸åŒè¯ï¼ˆå¤šå…‰æ ‡ï¼‰
- Ctrl+L: é€‰æ‹©å½“å‰è¡Œ
- Alt+Up/Down: ç§»åŠ¨å½“å‰è¡Œ
- Ctrl+Shift+K: åˆ é™¤å½“å‰è¡Œ
- Ctrl+/: æ³¨é‡Š/å–æ¶ˆæ³¨é‡Š
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šåŠŸèƒ½å¢å¼ºï¼ˆå‚è€ƒå¸‚é¢å·¥å…·ï¼‰

### 2.1 æŸ¥è¯¢åŠŸèƒ½å¢å¼º

#### 2.1.1 æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ (EXPLAIN) - DataGrip/DBeaver

```
å¿«æ·é”®: Ctrl+Shift+E æˆ– F6

åŠŸèƒ½:
- å¯è§†åŒ–æ˜¾ç¤ºæ‰§è¡Œè®¡åˆ’
- æ ‘å½¢ç»“æ„å±•ç¤ºå„æ­¥éª¤
- é«˜äº®æ€§èƒ½ç“¶é¢ˆ
- æ”¯æŒ SQLite/PostgreSQL/MySQL ä¸åŒæ ¼å¼
```

#### 2.1.2 æŸ¥è¯¢å‚æ•°åŒ– - DataGrip

```
æ”¯æŒåœ¨ SQL ä¸­ä½¿ç”¨å‚æ•°:
SELECT * FROM users WHERE id = :id AND status = :status

æ‰§è¡Œæ—¶å¼¹å‡ºå‚æ•°è¾“å…¥å¯¹è¯æ¡†:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŸ¥è¯¢å‚æ•°                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ :id     [________]              â”‚
â”‚ :status [________]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      [å–æ¶ˆ]    [æ‰§è¡Œ]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.1.3 æŸ¥è¯¢ç‰‡æ®µ/ä»£ç ç‰‡æ®µ - DBeaver/DataGrip

```
å¿«æ·é”®: Ctrl+J

åŠŸèƒ½:
- é¢„å®šä¹‰å¸¸ç”¨ SQL ç‰‡æ®µ
- ç”¨æˆ·è‡ªå®šä¹‰ç‰‡æ®µ
- æ”¯æŒå˜é‡å ä½ç¬¦

å†…ç½®ç‰‡æ®µ:
- sel*  â†’ SELECT * FROM |
- selc  â†’ SELECT COUNT(*) FROM |
- ins   â†’ INSERT INTO | (col1, col2) VALUES (?, ?)
- upd   â†’ UPDATE | SET col = ? WHERE id = ?
- del   â†’ DELETE FROM | WHERE id = ?
- crt   â†’ CREATE TABLE | (id INTEGER PRIMARY KEY)
```

### 2.2 æ•°æ®æµè§ˆå¢å¼º

#### 2.2.1 å•å…ƒæ ¼æ•°æ®é¢„è§ˆ - TablePlus

```
å¤§æ–‡æœ¬/JSON/äºŒè¿›åˆ¶æ•°æ®é¢„è§ˆ:
- é€‰ä¸­å•å…ƒæ ¼åæŒ‰ Space æˆ– Enter å¼¹å‡ºé¢„è§ˆ
- JSON è‡ªåŠ¨æ ¼å¼åŒ–å’Œè¯­æ³•é«˜äº®
- å›¾ç‰‡æ•°æ®ç›´æ¥é¢„è§ˆ
- äºŒè¿›åˆ¶æ•°æ®åå…­è¿›åˆ¶è§†å›¾
```

#### 2.2.2 æ•°æ®å¯è§†åŒ– - DBeaver

```
å¿«æ·é”®: Ctrl+Shift+V

åŠŸèƒ½:
- æ•°å€¼åˆ— â†’ æŸ±çŠ¶å›¾/æŠ˜çº¿å›¾
- åˆ†ç±»åˆ— â†’ é¥¼å›¾
- æ—¶é—´åºåˆ— â†’ æ—¶é—´çº¿å›¾
```

#### 2.2.3 å¤–é”®å¯¼èˆª - DataGrip

```
åŠŸèƒ½:
- åœ¨å¤–é”®åˆ—ä¸ŠæŒ‰ Ctrl+Click æˆ– gd è·³è½¬åˆ°å…³è”è¡¨
- æ˜¾ç¤ºå¤–é”®å…³ç³»å›¾æ ‡
- æ”¯æŒåå‘å¯¼èˆªï¼ˆæŸ¥çœ‹å“ªäº›è¡¨å¼•ç”¨äº†å½“å‰è¡¨ï¼‰
```

### 2.3 è¿æ¥ç®¡ç†å¢å¼º

#### 2.3.1 è¿æ¥åˆ†ç»„ - DBeaver/Navicat

```
åŠŸèƒ½:
- æŒ‰é¡¹ç›®/ç¯å¢ƒåˆ†ç»„è¿æ¥
- æ‹–æ”¾æ’åº
- é¢œè‰²æ ‡è®°ï¼ˆç”Ÿäº§=çº¢è‰², å¼€å‘=ç»¿è‰², æµ‹è¯•=è“è‰²ï¼‰
- å¿«é€Ÿå¤åˆ¶è¿æ¥é…ç½®
```

#### 2.3.2 è¿æ¥çŠ¶æ€ç›‘æ§ - DBeaver

```
åŠŸèƒ½:
- æ˜¾ç¤ºå½“å‰è¿æ¥æ•°
- æŸ¥è¯¢æ‰§è¡Œæ—¶é—´ç»Ÿè®¡
- è¿æ¥æ–­å¼€è‡ªåŠ¨é‡è¿
- ç©ºé—²è¿æ¥è¶…æ—¶è­¦å‘Š
```

### 2.4 æ¨¡å¼/Schema ç®¡ç†å¢å¼º

#### 2.4.1 æ¨¡å¼æ¯”è¾ƒ - DataGrip/DBeaver

```
å¿«æ·é”®: Ctrl+Shift+C

åŠŸèƒ½:
- æ¯”è¾ƒä¸¤ä¸ªæ•°æ®åº“/æ¨¡å¼çš„ç»“æ„å·®å¼‚
- ç”ŸæˆåŒæ­¥ SQL è„šæœ¬
- å¯è§†åŒ–å·®å¼‚å±•ç¤º
```

#### 2.4.2 æ¨¡å¼å¯¼å‡º - é€šç”¨åŠŸèƒ½

```
åŠŸèƒ½:
- å¯¼å‡ºå®Œæ•´ DDL (æ‰€æœ‰è¡¨ã€ç´¢å¼•ã€è§¦å‘å™¨)
- å¯¼å‡º ER å›¾ä¸ºå›¾ç‰‡ (PNG/SVG)
- å¯¼å‡ºæ–‡æ¡£ (Markdown/HTML)
```

### 2.5 AI è¾…åŠ© (å¯é€‰/æœªæ¥)

#### 2.5.1 è‡ªç„¶è¯­è¨€è½¬ SQL - DataGrip AI

```
åŠŸèƒ½:
- è¾“å…¥è‡ªç„¶è¯­è¨€æè¿°ï¼Œç”Ÿæˆ SQL
- è§£é‡Šå¤æ‚ SQL çš„å«ä¹‰
- SQL ä¼˜åŒ–å»ºè®®

ç•Œé¢:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– AI åŠ©æ‰‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ > æŸ¥è¯¢æœ€è¿‘7å¤©æ³¨å†Œçš„ç”¨æˆ·æ•°é‡æŒ‰æ—¥æœŸåˆ†ç»„       â”‚
â”‚                                             â”‚
â”‚ ç”Ÿæˆçš„ SQL:                                 â”‚
â”‚ SELECT DATE(created_at) as date,            â”‚
â”‚        COUNT(*) as count                    â”‚
â”‚ FROM users                                  â”‚
â”‚ WHERE created_at >= DATE('now', '-7 days')  â”‚
â”‚ GROUP BY DATE(created_at)                   â”‚
â”‚ ORDER BY date;                              â”‚
â”‚                                             â”‚
â”‚      [å¤åˆ¶]  [æ‰§è¡Œ]  [ç¼–è¾‘]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®æ–½è®¡åˆ’

### 3.1 Phase 1: æ ¸å¿ƒé”®ç›˜ä½“éªŒ (2-3 å‘¨)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ | æ–‡ä»¶ |
|------|--------|--------|------|
| ç»Ÿä¸€å‘½ä»¤é¢æ¿ | P0 | 3å¤© | `ui/components/command_palette.rs` |
| Helix Picker ç»„ä»¶ | P0 | 2å¤© | `ui/components/helix_picker.rs` |
| å¯¹è¯æ¡†é”®ç›˜å¯¼èˆª | P0 | 3å¤© | `ui/dialogs/*.rs` |
| å·¥å…·æ é”®ç›˜å¢å¼º | P1 | 2å¤© | `ui/components/toolbar/*.rs` |
| SQL ç¼–è¾‘å™¨æŸ¥æ‰¾æ›¿æ¢ | P1 | 2å¤© | `ui/components/sql_editor.rs` |

### 3.2 Phase 2: åŠŸèƒ½å¢å¼º (3-4 å‘¨)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ | æ–‡ä»¶ |
|------|--------|--------|------|
| æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ | P1 | 3å¤© | `core/explain.rs`, `ui/components/explain_view.rs` |
| ä»£ç ç‰‡æ®µç³»ç»Ÿ | P1 | 2å¤© | `core/snippets.rs` |
| å•å…ƒæ ¼æ•°æ®é¢„è§ˆ | P1 | 2å¤© | `ui/components/cell_preview.rs` |
| å¤–é”®å¯¼èˆª | P2 | 2å¤© | `ui/components/grid/actions.rs` |
| ER å›¾é”®ç›˜å¯¼èˆª | P2 | 2å¤© | `ui/components/er_diagram/keyboard.rs` |
| è¿æ¥åˆ†ç»„ | P2 | 2å¤© | `database/connection.rs`, `ui/panels/sidebar/*.rs` |

### 3.3 Phase 3: é«˜çº§åŠŸèƒ½ (4-6 å‘¨)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ | æ–‡ä»¶ |
|------|--------|--------|------|
| æ¨¡å¼æ¯”è¾ƒå·¥å…· | P2 | 5å¤© | `core/schema_diff.rs` |
| æŸ¥è¯¢å‚æ•°åŒ– | P2 | 2å¤© | `core/query_params.rs` |
| æ•°æ®å¯è§†åŒ– | P3 | 5å¤© | `ui/components/chart.rs` |
| æ¨¡å¼å¯¼å‡ºæ–‡æ¡£ | P3 | 3å¤© | `core/schema_export.rs` |
| AI è¾…åŠ© (å¯é€‰) | P4 | 7å¤© | `core/ai_assistant.rs` |

---

## ç¬¬å››éƒ¨åˆ†ï¼šæŠ€æœ¯å®ç°ç»†èŠ‚

### 4.1 å‘½ä»¤é¢æ¿æ¶æ„

```rust
// src/core/commands.rs

use std::collections::HashMap;

/// å‘½ä»¤å®šä¹‰
pub struct Command {
    pub id: &'static str,
    pub name: &'static str,
    pub description: &'static str,
    pub shortcut: Option<&'static str>,
    pub category: CommandCategory,
    pub action: CommandAction,
}

pub enum CommandCategory {
    Connection,
    Query,
    Data,
    View,
    Tools,
    Help,
}

pub enum CommandAction {
    /// ç®€å•æ“ä½œ
    Simple(fn(&mut AppState)),
    /// éœ€è¦å‚æ•°çš„æ“ä½œ
    WithInput(fn(&mut AppState, &str)),
    /// æ‰“å¼€å¯¹è¯æ¡†
    Dialog(DialogType),
}

/// å‘½ä»¤æ³¨å†Œä¸­å¿ƒ
pub struct CommandRegistry {
    commands: HashMap<&'static str, Command>,
    recent: Vec<&'static str>,
}

impl CommandRegistry {
    pub fn register(&mut self, command: Command) {
        self.commands.insert(command.id, command);
    }

    pub fn search(&self, query: &str) -> Vec<&Command> {
        // æ¨¡ç³Šæœç´¢å®ç°
    }

    pub fn execute(&mut self, id: &str, state: &mut AppState) {
        // æ‰§è¡Œå‘½ä»¤å¹¶è®°å½•åˆ°æœ€è¿‘ä½¿ç”¨
    }
}
```

### 4.2 Helix Picker ç»„ä»¶

```rust
// src/ui/components/helix_picker.rs

use egui::{self, Key, Response};

pub struct HelixPicker<'a, T> {
    id: egui::Id,
    items: &'a [T],
    selected: &'a mut usize,
    filter: &'a mut String,
    display_fn: fn(&T) -> String,
    filter_fn: fn(&T, &str) -> bool,
}

pub struct PickerResponse {
    pub confirmed: bool,
    pub cancelled: bool,
    pub changed: bool,
}

impl<'a, T> HelixPicker<'a, T> {
    pub fn new(
        id: impl std::hash::Hash,
        items: &'a [T],
        selected: &'a mut usize,
        filter: &'a mut String,
    ) -> Self {
        Self {
            id: egui::Id::new(id),
            items,
            selected,
            filter,
            display_fn: |_| String::new(),
            filter_fn: |_, _| true,
        }
    }

    pub fn display(mut self, f: fn(&T) -> String) -> Self {
        self.display_fn = f;
        self
    }

    pub fn filter(mut self, f: fn(&T, &str) -> bool) -> Self {
        self.filter_fn = f;
        self
    }

    pub fn show(self, ui: &mut egui::Ui) -> PickerResponse {
        let filtered: Vec<_> = self.items
            .iter()
            .enumerate()
            .filter(|(_, item)| (self.filter_fn)(item, self.filter))
            .collect();

        let mut response = PickerResponse {
            confirmed: false,
            cancelled: false,
            changed: false,
        };

        // é”®ç›˜å¤„ç†
        ui.input(|i| {
            // j/k æˆ– Ctrl+n/p å¯¼èˆª
            if i.key_pressed(Key::J) || (i.modifiers.ctrl && i.key_pressed(Key::N)) {
                *self.selected = (*self.selected + 1).min(filtered.len().saturating_sub(1));
                response.changed = true;
            }
            if i.key_pressed(Key::K) || (i.modifiers.ctrl && i.key_pressed(Key::P)) {
                *self.selected = self.selected.saturating_sub(1);
                response.changed = true;
            }

            // Enter ç¡®è®¤
            if i.key_pressed(Key::Enter) {
                response.confirmed = true;
            }

            // Esc å–æ¶ˆ
            if i.key_pressed(Key::Escape) {
                response.cancelled = true;
            }
        });

        // æ¸²æŸ“åˆ—è¡¨
        egui::ScrollArea::vertical()
            .max_height(300.0)
            .show(ui, |ui| {
                for (idx, (orig_idx, item)) in filtered.iter().enumerate() {
                    let is_selected = idx == *self.selected;
                    let text = (self.display_fn)(item);
                    
                    let response = ui.selectable_label(is_selected, &text);
                    if response.clicked() {
                        *self.selected = idx;
                        response.confirmed = true;
                    }
                }
            });

        response
    }
}
```

### 4.3 å¯¹è¯æ¡†é”®ç›˜å¯¼èˆª trait

```rust
// src/ui/dialogs/keyboard.rs

/// å¯¹è¯æ¡†é”®ç›˜å¯¼èˆª trait
pub trait KeyboardNavigable {
    /// è·å–å¯èšç„¦å­—æ®µæ•°é‡
    fn field_count(&self) -> usize;
    
    /// è·å–å½“å‰èšç„¦å­—æ®µ
    fn focused_field(&self) -> usize;
    
    /// è®¾ç½®èšç„¦å­—æ®µ
    fn set_focused_field(&mut self, index: usize);
    
    /// å¤„ç†é”®ç›˜è¾“å…¥
    fn handle_keyboard(&mut self, ctx: &egui::Context) -> DialogAction {
        if has_text_focus(ctx) {
            // åœ¨æ–‡æœ¬æ¡†ä¸­ï¼Œåªå¤„ç† Tab å’Œ Escape
            ctx.input(|i| {
                if i.key_pressed(Key::Tab) {
                    let next = if i.modifiers.shift {
                        self.focused_field().checked_sub(1)
                            .unwrap_or(self.field_count() - 1)
                    } else {
                        (self.focused_field() + 1) % self.field_count()
                    };
                    self.set_focused_field(next);
                    return DialogAction::FocusChanged;
                }
                if i.key_pressed(Key::Escape) {
                    return DialogAction::Cancel;
                }
                DialogAction::None
            })
        } else {
            // ä¸åœ¨æ–‡æœ¬æ¡†ä¸­ï¼Œå¤„ç†æ›´å¤šå¿«æ·é”®
            handle_dialog_keys(ctx)
        }
    }
}
```

---

## ç¬¬äº”éƒ¨åˆ†ï¼šå¿«æ·é”®å®Œæ•´å‚è€ƒ

### 5.1 å…¨å±€å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ | çŠ¶æ€ |
|--------|------|------|
| `Ctrl+P` | å‘½ä»¤é¢æ¿ | ğŸ†• æ–°å¢ |
| `Ctrl+N` | æ–°å»ºè¿æ¥ | âœ… å·²æœ‰ |
| `Ctrl+Shift+N` | æ–°å»ºè¡¨ | âœ… å·²æœ‰ |
| `Ctrl+E` | å¯¼å‡º | âœ… å·²æœ‰ |
| `Ctrl+I` | å¯¼å…¥ | âœ… å·²æœ‰ |
| `Ctrl+H` | å†å²è®°å½• | âœ… å·²æœ‰ |
| `Ctrl+R` | ER å…³ç³»å›¾ | âœ… å·²æœ‰ |
| `Ctrl+B` | ä¾§è¾¹æ  | âœ… å·²æœ‰ |
| `Ctrl+J` | SQL ç¼–è¾‘å™¨ | âœ… å·²æœ‰ |
| `Ctrl+F` | æ·»åŠ ç­›é€‰ / æŸ¥æ‰¾ | âš ï¸ éœ€åŒºåˆ†ä¸Šä¸‹æ–‡ |
| `Ctrl+G` | è·³è½¬åˆ°è¡Œ | ğŸ†• æ–°å¢ |
| `Ctrl+D` | æ—¥/å¤œæ¨¡å¼ | âœ… å·²æœ‰ |
| `Ctrl+T` | ä¸»é¢˜é€‰æ‹© | ğŸ†• æ–°å¢ |
| `Ctrl+Tab` | ä¸‹ä¸€ä¸ªæ ‡ç­¾ | âœ… å·²æœ‰ |
| `Ctrl+W` | å…³é—­æ ‡ç­¾ | âœ… å·²æœ‰ |
| `Ctrl+1-6` | ä¾§è¾¹æ åŒºåŸŸ | âœ… å·²æœ‰ |
| `F1` | å¸®åŠ© | âœ… å·²æœ‰ |
| `F5` | åˆ·æ–° | âœ… å·²æœ‰ |
| `Escape` | å–æ¶ˆ/å…³é—­ | âœ… å·²æœ‰ |

### 5.2 DataGrid å¿«æ·é”® (Helix é£æ ¼)

| å¿«æ·é”® | åŠŸèƒ½ | çŠ¶æ€ |
|--------|------|------|
| `hjkl` | å…‰æ ‡ç§»åŠ¨ | âœ… å·²æœ‰ |
| `w/b` | åˆ—è·³è½¬ | âœ… å·²æœ‰ |
| `gg/G` | é¦–/å°¾è¡Œ | âœ… å·²æœ‰ |
| `gh/gl` | è¡Œé¦–/å°¾ | âœ… å·²æœ‰ |
| `i/a/c` | ç¼–è¾‘æ¨¡å¼ | âœ… å·²æœ‰ |
| `v` | é€‰æ‹©æ¨¡å¼ | âœ… å·²æœ‰ |
| `x` | é€‰æ‹©æ•´è¡Œ | âœ… å·²æœ‰ |
| `d/dd` | åˆ é™¤ | âœ… å·²æœ‰ |
| `y/yy` | å¤åˆ¶ | âœ… å·²æœ‰ |
| `p` | ç²˜è´´ | âœ… å·²æœ‰ |
| `u/U` | æ’¤é”€ | âœ… å·²æœ‰ |
| `o/O` | æ–°å¢è¡Œ | âœ… å·²æœ‰ |
| `/` | ç­›é€‰é¢æ¿ | âœ… å·²æœ‰ |
| `f` | å½“å‰åˆ—ç­›é€‰ | âœ… å·²æœ‰ |
| `:w` | ä¿å­˜ | âœ… å·²æœ‰ |
| `Ctrl+S` | ä¿å­˜ | âœ… å·²æœ‰ |
| `zz/zt/zb` | æ»šåŠ¨è§†å›¾ | âœ… å·²æœ‰ |
| `gd` | å¤–é”®è·³è½¬ | ğŸ†• æ–°å¢ |
| `Space` | é¢„è§ˆå•å…ƒæ ¼ | ğŸ†• æ–°å¢ |

### 5.3 SQL ç¼–è¾‘å™¨å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ | çŠ¶æ€ |
|--------|------|------|
| `Ctrl+Enter` | æ‰§è¡Œ SQL | âœ… å·²æœ‰ |
| `Ctrl+;` | æ ¼å¼åŒ– | âœ… å·²æœ‰ |
| `Ctrl+Space` | è‡ªåŠ¨è¡¥å…¨ | âœ… å·²æœ‰ |
| `Ctrl+/` | æ³¨é‡Š | âœ… å·²æœ‰ |
| `Ctrl+F` | æŸ¥æ‰¾ | ğŸ†• æ–°å¢ |
| `Ctrl+H` | æ›¿æ¢ | ğŸ†• æ–°å¢ |
| `Ctrl+G` | è·³è½¬åˆ°è¡Œ | ğŸ†• æ–°å¢ |
| `Ctrl+D` | é€‰æ‹©ä¸‹ä¸€ä¸ªç›¸åŒè¯ | ğŸ†• æ–°å¢ |
| `Ctrl+L` | é€‰æ‹©å½“å‰è¡Œ | ğŸ†• æ–°å¢ |
| `Alt+Up/Down` | ç§»åŠ¨è¡Œ | ğŸ†• æ–°å¢ |
| `Ctrl+Shift+K` | åˆ é™¤è¡Œ | ğŸ†• æ–°å¢ |
| `Ctrl+J` | ä»£ç ç‰‡æ®µ | ğŸ†• æ–°å¢ |
| `Ctrl+Shift+E` | æ‰§è¡Œè®¡åˆ’ | ğŸ†• æ–°å¢ |

### 5.4 å¯¹è¯æ¡†å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ | çŠ¶æ€ |
|--------|------|------|
| `Tab` | ä¸‹ä¸€ä¸ªå­—æ®µ | âš ï¸ éœ€å®Œå–„ |
| `Shift+Tab` | ä¸Šä¸€ä¸ªå­—æ®µ | âš ï¸ éœ€å®Œå–„ |
| `Enter` | ç¡®è®¤/æäº¤ | âœ… å·²æœ‰ |
| `Escape` | å–æ¶ˆ/å…³é—­ | âœ… å·²æœ‰ |
| `1/2/3...` | å¿«é€Ÿé€‰æ‹©é€‰é¡¹ | âš ï¸ éƒ¨åˆ†æœ‰ |
| `h/l` | é€‰é¡¹é—´åˆ‡æ¢ | âš ï¸ éƒ¨åˆ†æœ‰ |
| `j/k` | åˆ—è¡¨å¯¼èˆª | âš ï¸ éƒ¨åˆ†æœ‰ |
| `Space` | åˆ‡æ¢å¤é€‰æ¡† | âš ï¸ éƒ¨åˆ†æœ‰ |

---

## ç¬¬å…­éƒ¨åˆ†ï¼šè´¨é‡ä¿è¯

### 6.1 æµ‹è¯•è®¡åˆ’

1. **å•å…ƒæµ‹è¯•**: æ¯ä¸ªæ–°ç»„ä»¶çš„é”®ç›˜å¤„ç†é€»è¾‘
2. **é›†æˆæµ‹è¯•**: ç„¦ç‚¹è½¬ç§»æµç¨‹
3. **E2E æµ‹è¯•**: å®Œæ•´çš„é”®ç›˜æ“ä½œå·¥ä½œæµ

### 6.2 æ–‡æ¡£æ›´æ–°

1. æ›´æ–° `KEYBINDINGS.md` å¿«æ·é”®å‚è€ƒ
2. æ›´æ–° README åŠŸèƒ½åˆ—è¡¨
3. æ·»åŠ å¸®åŠ©å¯¹è¯æ¡†ä¸­çš„å¿«æ·é”®è¯´æ˜

### 6.3 ç”¨æˆ·ä½“éªŒæµ‹è¯•

1. é‚€è¯· Vim/Helix ç”¨æˆ·è¿›è¡Œæµ‹è¯•
2. æ”¶é›†åé¦ˆå¹¶è¿­ä»£æ”¹è¿›
3. ç¡®ä¿æ— éšœç¢è®¿é—®

---

## æ€»ç»“

æœ¬ä¼˜åŒ–è®¡åˆ’çš„æ ¸å¿ƒç›®æ ‡æ˜¯:

1. **çº¯é”®ç›˜æ“ä½œ**: æ‰€æœ‰åŠŸèƒ½éƒ½å¯ä»¥é€šè¿‡é”®ç›˜å®Œæˆï¼Œè¾¾åˆ° TUI çº§åˆ«ä½“éªŒ
2. **Helix é£æ ¼ä¸€è‡´æ€§**: ç»Ÿä¸€ä½¿ç”¨ Helix/Vim é£æ ¼å¿«æ·é”®
3. **åŠŸèƒ½å®Œæ•´æ€§**: æ•´åˆå¸‚é¢ä¸»æµå·¥å…·çš„æœ€ä½³åŠŸèƒ½
4. **æ¸è¿›å¼å®æ–½**: åˆ†é˜¶æ®µå®æ–½ï¼Œç¡®ä¿ç¨³å®šæ€§

é¢„è®¡æ€»å·¥æœŸ: 8-12 å‘¨ï¼ˆå–å†³äºå¯é€‰åŠŸèƒ½çš„å–èˆï¼‰
